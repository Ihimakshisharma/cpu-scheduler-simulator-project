<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CPU Scheduler Simulator – Web</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* --------- GLOBAL --------- */
    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: radial-gradient(circle at top, #111827, #020617 55%);
      color: #e5e7eb;
      display: flex;
      justify-content: center;
      padding: 24px;
    }

    .app-shell {
      width: 100%;
      max-width: 1200px;
      background: linear-gradient(145deg, rgba(15,23,42,0.95), rgba(30,64,175,0.65));
      border-radius: 24px;
      padding: 24px 24px 16px;
      box-shadow:
        0 30px 80px rgba(15,23,42,0.9),
        inset 0 0 0 1px rgba(148,163,184,0.2);
      backdrop-filter: blur(18px);
      border: 1px solid rgba(148,163,184,0.35);
    }

    /* --------- HEADER --------- */
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 16px;
      margin-bottom: 20px;
    }

    .title-block {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .title {
      font-size: 1.5rem;
      font-weight: 700;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .title-pill {
      font-size: 0.7rem;
      padding: 3px 8px;
      border-radius: 999px;
      background: radial-gradient(circle at top left, #22c55e, #22c55e22);
      border: 1px solid #22c55e66;
      text-transform: uppercase;
    }

    .subtitle {
      font-size: 0.9rem;
      color: #cbd5f5;
      opacity: 0.9;
    }

    .authors {
      font-size: 0.85rem;
      color: #a5b4fc;
      padding: 6px 12px;
      border-radius: 999px;
      background: radial-gradient(circle at top left, rgba(59,130,246,0.4), rgba(15,23,42,0.8));
      border: 1px solid rgba(129,140,248,0.6);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
    }

    .authors span:first-child {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: #e5e7eb;
    }

    /* --------- LAYOUT --------- */
    .layout {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.4fr);
      gap: 18px;
    }

    @media (max-width: 900px) {
      .layout {
        grid-template-columns: 1fr;
      }
    }

    .card {
      background: linear-gradient(145deg, rgba(15,23,42,0.96), rgba(30,64,175,0.6));
      border-radius: 18px;
      padding: 16px 16px 14px;
      border: 1px solid rgba(148,163,184,0.35);
      box-shadow:
        0 18px 40px rgba(15,23,42,0.7),
        inset 0 0 0 1px rgba(15,23,42,0.75);
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: -40%;
      background:
        radial-gradient(circle at 0% 0%, rgba(56,189,248,0.06), transparent 55%),
        radial-gradient(circle at 100% 0%, rgba(129,140,248,0.08), transparent 55%);
      opacity: 0.9;
      pointer-events: none;
    }

    .card-inner {
      position: relative;
      z-index: 1;
    }

    .card-title {
      font-size: 0.95rem;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: #9ca3af;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .pill-soft {
      font-size: 0.65rem;
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(15,23,42,0.9);
      border: 1px solid rgba(148,163,184,0.5);
      color: #e5e7eb;
    }

    /* --------- FORM / INPUTS --------- */
    .field-group {
      margin-bottom: 10px;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 10px;
    }

    label {
      font-size: 0.85rem;
      color: #cbd5e1;
    }

    select, input[type="number"] {
      background: rgba(15,23,42,0.95);
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.7);
      color: #e5e7eb;
      padding: 6px 10px;
      font-size: 0.85rem;
      outline: none;
      min-width: 80px;
      transition: border-color 0.18s ease, box-shadow 0.18s ease, transform 0.12s ease;
    }

    select:focus, input[type="number"]:focus {
      border-color: #60a5fa;
      box-shadow: 0 0 0 1px rgba(96,165,250,0.7);
      transform: translateY(-0.5px);
    }

    input[type="number"]::-webkit-outer-spin-button,
    input[type="number"]::-webkit-inner-spin-button {
      margin: 0;
    }

    .field-help {
      font-size: 0.77rem;
      color: #9ca3af;
    }

    /* --------- PROCESS TABLE --------- */
    .table-container {
      margin-top: 8px;
      border-radius: 14px;
      overflow: hidden;
      border: 1px solid rgba(55,65,81,0.9);
      background: radial-gradient(circle at top, rgba(15,23,42,1), rgba(15,23,42,0.96));
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.82rem;
    }

    thead {
      background: linear-gradient(90deg, rgba(37,99,235,0.9), rgba(129,140,248,0.95));
    }

    th, td {
      padding: 5px 6px;
      text-align: center;
      border-bottom: 1px solid rgba(31,41,55,0.9);
    }

    th {
      font-weight: 600;
      color: #e5e7eb;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      font-size: 0.7rem;
      white-space: nowrap;
    }

    tbody tr:nth-child(even) {
      background: rgba(15,23,42,0.95);
    }

    tbody tr:nth-child(odd) {
      background: rgba(15,23,42,0.9);
    }

    .pid-cell {
      font-weight: 600;
      color: #a5b4fc;
      font-size: 0.85rem;
    }

    .proc-input {
      width: 70px;
    }

    .table-actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: 6px;
      gap: 8px;
    }

    .small-note {
      font-size: 0.75rem;
      color: #9ca3af;
    }

    /* --------- BUTTONS --------- */
    .btn {
      border-radius: 999px;
      border: none;
      cursor: pointer;
      font-size: 0.82rem;
      padding: 7px 14px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      font-weight: 600;
      transition:
        transform 0.12s ease,
        box-shadow 0.12s ease,
        background 0.15s ease,
        opacity 0.15s ease;
      white-space: nowrap;
    }

    .btn:active {
      transform: translateY(1px) scale(0.98);
      box-shadow: none;
    }

    .btn-primary {
      background: radial-gradient(circle at top left, #22c55e, #16a34a);
      color: #022c22;
      box-shadow: 0 10px 25px rgba(22,163,74,0.6);
    }

    .btn-primary:hover {
      background: radial-gradient(circle at top left, #4ade80, #22c55e);
    }

    .btn-ghost {
      background: rgba(15,23,42,0.9);
      color: #e5e7eb;
      border: 1px solid rgba(148,163,184,0.7);
    }

    .btn-ghost:hover {
      background: rgba(31,41,55,0.95);
    }

    .btn-icon {
      font-size: 1rem;
    }

    /* --------- OUTPUT PANEL --------- */
    .fade-in {
      animation: fadeInSoft 0.4s ease-out;
    }

    @keyframes fadeInSoft {
      from {
        opacity: 0;
        transform: translateY(6px) scale(0.98);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .results-summary {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 8px;
      align-items: center;
      justify-content: space-between;
    }

    .chip {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.6);
      font-size: 0.78rem;
      color: #e5e7eb;
      background: rgba(15,23,42,0.9);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .chip strong {
      color: #a5b4fc;
      font-weight: 600;
    }

    .output-section-title {
      font-size: 0.8rem;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: #9ca3af;
      margin-bottom: 4px;
    }

    .gantt-wrapper {
      margin-bottom: 10px;
      border-radius: 14px;
      border: 1px solid rgba(55,65,81,0.9);
      background: radial-gradient(circle at top, rgba(15,23,42,1), rgba(15,23,42,0.95));
      padding: 10px 10px 8px;
      overflow-x: auto;
    }

    .gantt-rail {
      display: flex;
      align-items: stretch;
      gap: 3px;
      padding-bottom: 4px;
      min-height: 40px;
    }

    .gantt-segment {
      position: relative;
      border-radius: 10px;
      min-width: 36px;
      padding: 6px 0;
      font-size: 0.8rem;
      text-align: center;
      color: #0b1120;
      font-weight: 600;
      box-shadow: 0 6px 16px rgba(15,23,42,0.8);
      opacity: 0;
      transform: translateY(8px) scale(0.97);
      animation: popInSegment 0.4s ease-out forwards;
    }

    @keyframes popInSegment {
      from {
        opacity: 0;
        transform: translateY(10px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .gantt-segment.busy {
      background: linear-gradient(145deg, #38bdf8, #6366f1);
      border: 1px solid rgba(191,219,254,0.9);
    }

    .gantt-segment.idle {
      background: linear-gradient(145deg, #4b5563, #6b7280);
      color: #e5e7eb;
      border: 1px solid rgba(156,163,175,0.9);
      font-size: 0.75rem;
    }

    .gantt-times {
      display: flex;
      align-items: center;
      gap: 3px;
      font-size: 0.75rem;
      color: #9ca3af;
    }

    .gantt-times span {
      display: inline-flex;
      justify-content: center;
      min-width: 36px;
    }

    .hidden {
      display: none;
    }

    /* --------- FOOTER --------- */
    footer {
      margin-top: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.75rem;
      color: #9ca3af;
      gap: 10px;
      flex-wrap: wrap;
    }

    .tagline {
      opacity: 0.9;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 10px rgba(34,197,94,0.9);
    }

    .live-indicator {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

  </style>
</head>
<body>
  <div class="app-shell">
    <header>
      <div class="title-block">
        <div class="title">
          CPU Scheduler Simulator
          <span class="title-pill">Web Edition</span>
        </div>
        <div class="subtitle">
          Visualize FCFS, SJF, Priority and Round Robin with animated Gantt charts.
        </div>
      </div>
      <div class="authors">
        <span>AUTHORS</span>
        <span>Himakshi &amp; Erka</span>
      </div>
    </header>

    <main class="layout">
      <!-- LEFT: INPUT PANEL -->
      <section class="card">
        <div class="card-inner">
          <div class="card-title">
            Simulation Setup
            <span class="pill-soft">Define processes &amp; choose algorithm</span>
          </div>

          <div class="field-group">
            <label for="algorithm-select">Algorithm</label>
            <select id="algorithm-select">
              <option value="fcfs">FCFS (First Come First Serve)</option>
              <option value="sjf">SJF – Non-preemptive</option>
              <option value="priority">Priority – Non-preemptive</option>
              <option value="rr">Round Robin</option>
            </select>
            <span class="field-help">
              Priority: lower number = higher priority
            </span>
          </div>

          <div class="field-group">
            <label for="quantum-input">Time Quantum (for Round Robin)</label>
            <input id="quantum-input" type="number" min="1" value="2" />
          </div>

          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>PID</th>
                  <th>Arrival Time</th>
                  <th>Burst Time</th>
                  <th>Priority</th>
                </tr>
              </thead>
              <tbody id="process-table-body">
                <!-- Rows added via JS -->
              </tbody>
            </table>
          </div>

          <div class="table-actions">
            <div>
              <button id="add-process-btn" class="btn btn-ghost">
                <span class="btn-icon">＋</span> Add Process
              </button>
              <button id="clear-process-btn" class="btn btn-ghost" style="margin-left: 6px; opacity: 0.9;">
                Clear
              </button>
            </div>
            <div class="small-note">
              Tip: Keep times small (like 0–20) for nicer charts.
            </div>
          </div>

          <div style="margin-top: 10px; display: flex; justify-content: flex-end;">
            <button id="run-btn" class="btn btn-primary">
              <span class="btn-icon">▶</span> Run Simulation
            </button>
          </div>
        </div>
      </section>

      <!-- RIGHT: OUTPUT PANEL -->
      <section class="card">
        <div class="card-inner">
          <div class="card-title">
            Output &amp; Visualization
            <span class="pill-soft">Animated Gantt chart + metrics</span>
          </div>

          <div id="placeholder" class="small-note" style="margin-bottom: 6px;">
            Configure your processes on the left and click <b>Run Simulation</b> to see results here.
          </div>

          <div id="result-panel" class="hidden fade-in">
            <div class="results-summary">
              <div class="chip">
                Algorithm:&nbsp;<strong id="summary-algorithm">FCFS</strong>
              </div>
              <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                <div class="chip">
                  Avg WT:&nbsp;<strong id="summary-avg-wt">0</strong>
                </div>
                <div class="chip">
                  Avg TAT:&nbsp;<strong id="summary-avg-tat">0</strong>
                </div>
              </div>
            </div>

            <div>
              <div class="output-section-title">Gantt Chart</div>
              <div class="gantt-wrapper">
                <div id="gantt-rail" class="gantt-rail"></div>
                <div id="gantt-times" class="gantt-times"></div>
              </div>
            </div>

            <div style="margin-top: 6px;">
              <div class="output-section-title">Process Table</div>
              <div class="table-container" style="margin-top: 4px;">
                <table>
                  <thead>
                    <tr>
                      <th>PID</th>
                      <th>AT</th>
                      <th>BT</th>
                      <th>PRI</th>
                      <th>ST</th>
                      <th>CT</th>
                      <th>WT</th>
                      <th>TAT</th>
                    </tr>
                  </thead>
                  <tbody id="result-table-body">
                  </tbody>
                </table>
              </div>
            </div>
          </div>

        </div>
      </section>
    </main>

    <footer>
      <div class="tagline">
        Designed for OS lab demos &amp; viva – understand scheduling, don’t just mug it.
      </div>
      <div class="live-indicator">
        <span class="status-dot"></span>
        <span>Interactive web simulator · C++ logic inspired</span>
      </div>
    </footer>
  </div>

  <script>
    // --------- DATA MODEL UTILS ---------
    function createProcessListFromInputs() {
      const rows = Array.from(document.querySelectorAll("#process-table-body tr"));
      const processes = [];

      for (let i = 0; i < rows.length; i++) {
        const row = rows[i];
        const arrival = Number(row.querySelector(".arrival-input").value);
        const burst = Number(row.querySelector(".burst-input").value);
        const priority = Number(row.querySelector(".priority-input").value);

        if (
          Number.isNaN(arrival) ||
          Number.isNaN(burst) ||
          Number.isNaN(priority) ||
          burst <= 0
        ) {
          alert("Please fill all Arrival, Burst (>0) and Priority fields with valid numbers.");
          return null;
        }

        processes.push({
          pid: i + 1,
          arrival,
          burst,
          priority
        });
      }

      if (processes.length === 0) {
        alert("Add at least one process.");
        return null;
      }

      return processes;
    }

    function cloneForSimulation(processes) {
      return processes.map(p => ({
        pid: p.pid,
        arrival: p.arrival,
        burst: p.burst,
        priority: p.priority,
        remaining: p.burst,
        start: -1,
        completion: 0,
        waiting: 0,
        turnaround: 0
      }));
    }

    // --------- ALGORITHMS ---------

    function runFCFS(inputProcesses) {
      let p = cloneForSimulation(inputProcesses);
      p.sort((a, b) => a.arrival === b.arrival ? a.pid - b.pid : a.arrival - b.arrival);

      const gantt = [];
      let time = 0;
      let totalWT = 0;
      let totalTAT = 0;

      for (const pr of p) {
        if (time < pr.arrival) {
          gantt.push({ pid: -1, start: time, end: pr.arrival });
          time = pr.arrival;
        }
        pr.start = time;
        gantt.push({ pid: pr.pid, start: time, end: time + pr.burst });
        time += pr.burst;
        pr.completion = time;
        pr.turnaround = pr.completion - pr.arrival;
        pr.waiting = pr.turnaround - pr.burst;
        totalWT += pr.waiting;
        totalTAT += pr.turnaround;
      }

      return {
        name: "FCFS",
        processes: p,
        gantt,
        avgWT: totalWT / p.length,
        avgTAT: totalTAT / p.length
      };
    }

    function runSJFNonPreemptive(inputProcesses) {
      let p = cloneForSimulation(inputProcesses);
      const n = p.length;
      const done = new Array(n).fill(false);
      const gantt = [];

      let completed = 0;
      let totalWT = 0;
      let totalTAT = 0;

      let minArrival = p[0].arrival;
      for (const pr of p) if (pr.arrival < minArrival) minArrival = pr.arrival;
      let time = minArrival;

      while (completed < n) {
        let idx = -1;
        let bestBT = Infinity;

        for (let i = 0; i < n; i++) {
          if (!done[i] && p[i].arrival <= time) {
            if (
              idx === -1 ||
              p[i].burst < bestBT ||
              (p[i].burst === bestBT && p[i].arrival < p[idx].arrival)
            ) {
              bestBT = p[i].burst;
              idx = i;
            }
          }
        }

        if (idx === -1) {
          let nextArrival = Infinity;
          for (let i = 0; i < n; i++) {
            if (!done[i] && p[i].arrival < nextArrival) {
              nextArrival = p[i].arrival;
            }
          }
          if (nextArrival === Infinity) break; // safety
          gantt.push({ pid: -1, start: time, end: nextArrival });
          time = nextArrival;
          continue;
        }

        const pr = p[idx];
        pr.start = time;
        gantt.push({ pid: pr.pid, start: time, end: time + pr.burst });
        time += pr.burst;
        pr.completion = time;
        pr.turnaround = pr.completion - pr.arrival;
        pr.waiting = pr.turnaround - pr.burst;
        done[idx] = true;
        completed++;
        totalWT += pr.waiting;
        totalTAT += pr.turnaround;
      }

      return {
        name: "SJF (Non-preemptive)",
        processes: p,
        gantt,
        avgWT: totalWT / n,
        avgTAT: totalTAT / n
      };
    }

    function runPriorityNonPreemptive(inputProcesses) {
      let p = cloneForSimulation(inputProcesses);
      const n = p.length;
      const done = new Array(n).fill(false);
      const gantt = [];

      let completed = 0;
      let totalWT = 0;
      let totalTAT = 0;

      let minArrival = p[0].arrival;
      for (const pr of p) if (pr.arrival < minArrival) minArrival = pr.arrival;
      let time = minArrival;

      while (completed < n) {
        let idx = -1;
        let bestPri = Infinity;

        for (let i = 0; i < n; i++) {
          if (!done[i] && p[i].arrival <= time) {
            if (
              idx === -1 ||
              p[i].priority < bestPri ||
              (p[i].priority === bestPri && p[i].arrival < p[idx].arrival)
            ) {
              bestPri = p[i].priority;
              idx = i;
            }
          }
        }

        if (idx === -1) {
          let nextArrival = Infinity;
          for (let i = 0; i < n; i++) {
            if (!done[i] && p[i].arrival < nextArrival) {
              nextArrival = p[i].arrival;
            }
          }
          if (nextArrival === Infinity) break;
          gantt.push({ pid: -1, start: time, end: nextArrival });
          time = nextArrival;
          continue;
        }

        const pr = p[idx];
        pr.start = time;
        gantt.push({ pid: pr.pid, start: time, end: time + pr.burst });
        time += pr.burst;
        pr.completion = time;
        pr.turnaround = pr.completion - pr.arrival;
        pr.waiting = pr.turnaround - pr.burst;
        done[idx] = true;
        completed++;
        totalWT += pr.waiting;
        totalTAT += pr.turnaround;
      }

      return {
        name: "Priority (Non-preemptive)",
        processes: p,
        gantt,
        avgWT: totalWT / n,
        avgTAT: totalTAT / n
      };
    }

    function runRoundRobin(inputProcesses, quantum) {
      if (!quantum || quantum <= 0) quantum = 1;

      let p = cloneForSimulation(inputProcesses);
      p.sort((a, b) => a.arrival === b.arrival ? a.pid - b.pid : a.arrival - b.arrival);

      const n = p.length;
      const gantt = [];
      let totalWT = 0;
      let totalTAT = 0;

      let time = p[0].arrival;
      let completed = 0;
      let q = [];
      let index = 0;

      while (completed < n) {
        // add processes that have arrived
        while (index < n && p[index].arrival <= time) {
          q.push(index);
          index++;
        }

        if (q.length === 0) {
          if (index < n) {
            const nextArrival = p[index].arrival;
            gantt.push({ pid: -1, start: time, end: nextArrival });
            time = nextArrival;
            continue;
          } else {
            break;
          }
        }

        const i = q.shift();
        const pr = p[i];

        if (pr.start === -1) pr.start = time;

        const runFor = Math.min(quantum, pr.remaining);
        gantt.push({ pid: pr.pid, start: time, end: time + runFor });
        time += runFor;
        pr.remaining -= runFor;

        // add newly arrived processes during this time slice
        while (index < n && p[index].arrival <= time) {
          q.push(index);
          index++;
        }

        if (pr.remaining > 0) {
          q.push(i);
        } else {
          pr.completion = time;
          pr.turnaround = pr.completion - pr.arrival;
          pr.waiting = pr.turnaround - pr.burst;
          totalWT += pr.waiting;
          totalTAT += pr.turnaround;
          completed++;
        }
      }

      return {
        name: `Round Robin (q = ${quantum})`,
        processes: p,
        gantt,
        avgWT: totalWT / n,
        avgTAT: totalTAT / n
      };
    }

    // --------- RENDERING ---------
    function renderResults(result) {
      const placeholder = document.getElementById("placeholder");
      const panel = document.getElementById("result-panel");
      const ganttRail = document.getElementById("gantt-rail");
      const ganttTimes = document.getElementById("gantt-times");
      const resultBody = document.getElementById("result-table-body");

      placeholder.classList.add("hidden");
      panel.classList.remove("hidden");

      // Summary
      document.getElementById("summary-algorithm").textContent = result.name;
      document.getElementById("summary-avg-wt").textContent = result.avgWT.toFixed(2);
      document.getElementById("summary-avg-tat").textContent = result.avgTAT.toFixed(2);

      // Gantt
      ganttRail.innerHTML = "";
      ganttTimes.innerHTML = "";

      if (result.gantt.length === 0) return;

      const unitWidth = 40; // px per time unit

      result.gantt.forEach((seg, index) => {
        const segDiv = document.createElement("div");
        segDiv.className = "gantt-segment " + (seg.pid === -1 ? "idle" : "busy");
        segDiv.style.width = (seg.end - seg.start) * unitWidth + "px";
        segDiv.textContent = seg.pid === -1 ? "IDLE" : "P" + seg.pid;
        segDiv.style.animationDelay = (index * 0.08) + "s";
        ganttRail.appendChild(segDiv);
      });

      // Time labels: first show start of first segment
      const firstStart = result.gantt[0].start;
      const startSpan = document.createElement("span");
      startSpan.textContent = firstStart;
      startSpan.style.minWidth = "24px";
      startSpan.style.marginRight = "2px";
      ganttTimes.appendChild(startSpan);

      result.gantt.forEach(seg => {
        const tSpan = document.createElement("span");
        tSpan.textContent = seg.end;
        tSpan.style.width = (seg.end - seg.start) * unitWidth + "px";
        ganttTimes.appendChild(tSpan);
      });

      // Table
      resultBody.innerHTML = "";
      result.processes
        .slice()
        .sort((a, b) => a.pid - b.pid)
        .forEach(pr => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td class="pid-cell">P${pr.pid}</td>
            <td>${pr.arrival}</td>
            <td>${pr.burst}</td>
            <td>${pr.priority}</td>
            <td>${pr.start}</td>
            <td>${pr.completion}</td>
            <td>${pr.waiting}</td>
            <td>${pr.turnaround}</td>
          `;
          resultBody.appendChild(tr);
        });
    }

    // --------- UI WIRING ---------
    function addProcessRow(pid, arrival = 0, burst = 4, priority = 1) {
      const tbody = document.getElementById("process-table-body");
      const tr = document.createElement("tr");

      tr.innerHTML = `
        <td class="pid-cell">P${pid}</td>
        <td><input type="number" min="0" value="${arrival}" class="proc-input arrival-input" /></td>
        <td><input type="number" min="1" value="${burst}" class="proc-input burst-input" /></td>
        <td><input type="number" value="${priority}" class="proc-input priority-input" /></td>
      `;

      tbody.appendChild(tr);
    }

    function resetProcessRows() {
      const tbody = document.getElementById("process-table-body");
      tbody.innerHTML = "";
      addProcessRow(1, 0, 5, 2);
      addProcessRow(2, 2, 3, 1);
      addProcessRow(3, 4, 4, 3);
    }

    document.addEventListener("DOMContentLoaded", () => {
      // Initial rows
      resetProcessRows();

      document.getElementById("add-process-btn").addEventListener("click", () => {
        const tbody = document.getElementById("process-table-body");
        const pid = tbody.querySelectorAll("tr").length + 1;
        addProcessRow(pid, 0, 3, 1);
      });

      document.getElementById("clear-process-btn").addEventListener("click", () => {
        const tbody = document.getElementById("process-table-body");
        tbody.innerHTML = "";
      });

      document.getElementById("run-btn").addEventListener("click", () => {
        const processes = createProcessListFromInputs();
        if (!processes) return;

        const algo = document.getElementById("algorithm-select").value;
        let result;

        if (algo === "fcfs") {
          result = runFCFS(processes);
        } else if (algo === "sjf") {
          result = runSJFNonPreemptive(processes);
        } else if (algo === "priority") {
          result = runPriorityNonPreemptive(processes);
        } else if (algo === "rr") {
          const q = Number(document.getElementById("quantum-input").value) || 1;
          result = runRoundRobin(processes, q);
        }

        renderResults(result);
      });
    });
  </script>
</body>
</html>

